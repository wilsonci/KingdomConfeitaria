<?xml version="1.0" encoding="utf-8"?>
<!-- 
  Configuração de Transformação para PRODUÇÃO
  Este arquivo é aplicado automaticamente quando você publica com configuração "Release"
  
  IMPORTANTE: 
  - Atualize a connection string com os dados do servidor de produção
  - Atualize a BaseUrl com o domínio de produção
  - Verifique todas as configurações antes de publicar
-->
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <system.web>
    <compilation xdt:Transform="RemoveAttributes(debug)" />
    <customErrors xdt:Transform="SetAttributes(mode)" mode="RemoteOnly" />
  </system.web>
  
  <connectionStrings>
    <!-- CONFIGURAÇÃO DE PRODUÇÃO -->
    <!-- 
      LocalDB em produção - Banco de dados na pasta App_Data da aplicação
      O banco será criado automaticamente na primeira execução
      Caminho: [Pasta da Aplicação]\App_Data\KingdomConfeitaria_Prod.mdf
    -->
    <add name="KingdomConfeitariaDB" 
         connectionString="Data Source=.\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\KingdomConfeitaria_Prod.mdf;Initial Catalog=KingdomConfeitaria_Prod;Integrated Security=True;Connect Timeout=30;MultipleActiveResultSets=True" 
         providerName="System.Data.SqlClient" 
         xdt:Transform="SetAttributes" 
         xdt:Locator="Match(name)" />
  </connectionStrings>
  
  <appSettings>
    <!-- Ambiente: Production -->
    <add key="Environment" 
         value="Production" 
         xdt:Transform="SetAttributes" 
         xdt:Locator="Match(key)" />
    
    <!-- URL Base - Produção -->
    <!-- ATUALIZE COM O DOMÍNIO DE PRODUÇÃO -->
    <add key="BaseUrl" 
         value="https://kingdomconfeitaria.com.br" 
         xdt:Transform="SetAttributes" 
         xdt:Locator="Match(key)" />
    
    <!-- Senha SMTP de Produção - Usando a mesma senha de desenvolvimento -->
    <add key="SmtpPassword" 
         value="WaNi5IdwRTB5FCiVRmbo1Bui1huwNuaTcINmTBMSF34=" 
         xdt:Transform="SetAttributes" 
         xdt:Locator="Match(key)" />
  </appSettings>
  
  <system.webServer>
    <rewrite>
      <rules>
        <!-- Forçar HTTPS em produção -->
        <rule name="Force HTTPS" stopProcessing="true" xdt:Transform="Insert">
          <match url="(.*)" />
          <conditions>
            <add input="{HTTPS}" pattern="off" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
</configuration>

